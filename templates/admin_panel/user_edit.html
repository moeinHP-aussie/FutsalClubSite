{% extends "base.html" %}
{% block title %}ÙˆÛŒØ±Ø§ÛŒØ´ â€” {{ u.username }}{% endblock %}
{% block nav_admin %}active{% endblock %}

{% block breadcrumb %}
  <span class="sep">â€º</span>
  <a href="{% url 'admin_panel:user-list' %}" style="text-decoration:none;color:inherit">Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</a>
  <span class="sep">â€º</span><span class="cur">{{ u.get_full_name }}</span>
{% endblock %}

{% block content %}

<!-- â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:.75rem;margin-bottom:1.25rem">
  <div style="display:flex;align-items:center;gap:.85rem">
    <div style="width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,var(--navy),var(--teal));
                display:flex;align-items:center;justify-content:center;font-size:1.4rem;color:#fff;font-weight:900">
      {{ u.first_name|first|upper|default:"?" }}
    </div>
    <div>
      <h1 style="font-size:1.1rem;font-weight:900;color:var(--navy)">
        {{ u.get_full_name }}
        {% if not u.is_active %}<span class="badge badge-red" style="font-size:.65rem">ØºÛŒØ±ÙØ¹Ø§Ù„</span>{% endif %}
        {% if u.is_superuser %}<span class="badge" style="background:#7c3aed;color:#fff;font-size:.65rem">â­ Ø³ÙˆÙ¾Ø±</span>{% endif %}
      </h1>
      <p style="font-size:.8rem;color:var(--text-muted)">
        @{{ u.username }} &nbsp;Â·&nbsp; Ø¹Ø¶ÙˆÛŒØª: {{ u.date_joined|date:"Y/m/d" }}
        {% if u.last_login %}&nbsp;Â·&nbsp; Ø¢Ø®Ø±ÛŒÙ† ÙˆØ±ÙˆØ¯: {{ u.last_login|date:"Y/m/d" }}{% endif %}
      </p>
    </div>
  </div>
  <div style="display:flex;gap:.5rem">
    <form method="post" style="margin:0">
      {% csrf_token %}
      <input type="hidden" name="action" value="toggle_active">
      <button type="submit" class="btn {% if u.is_active %}btn-outline{% else %}btn-green{% endif %} btn-sm"
              onclick="return confirm('ÙˆØ¶Ø¹ÛŒØª Ø­Ø³Ø§Ø¨ ØªØºÛŒÛŒØ± Ú©Ù†Ø¯ØŸ')">
        {% if u.is_active %}ğŸ”’ ØºÛŒØ±ÙØ¹Ø§Ù„â€ŒÚ©Ø±Ø¯Ù†{% else %}ğŸ”“ ÙØ¹Ø§Ù„â€ŒÚ©Ø±Ø¯Ù†{% endif %}
      </button>
    </form>
    <a href="{% url 'admin_panel:user-list' %}" class="btn btn-outline btn-sm">â† Ø¨Ø§Ø²Ú¯Ø´Øª</a>
  </div>
</div>

<!-- Flash messages -->
{% if messages %}
  {% for msg in messages %}
  <div style="border-radius:8px;padding:.65rem 1rem;font-size:.85rem;margin-bottom:.4rem;
    background:{% if msg.tags == 'success' %}#dcfce7{% elif msg.tags == 'error' %}#fee2e2{% elif msg.tags == 'warning' %}#fef9c3{% else %}#dbeafe{% endif %};
    color:{% if msg.tags == 'success' %}#15803d{% elif msg.tags == 'error' %}#b91c1c{% elif msg.tags == 'warning' %}#854d0e{% else %}#1e40af{% endif %}">
    {{ msg }}
  </div>
  {% endfor %}
{% endif %}

<!-- â”€â”€â”€ Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">

<!-- â•â•â• Ø³ØªÙˆÙ† Ú†Ù¾ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div style="display:flex;flex-direction:column;gap:1rem">

  <!-- â‘  Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø§ÛŒÙ‡ Ú©Ø§Ø±Ø¨Ø± -->
  <div class="card">
    <div class="card-header"><span class="card-title">ğŸ‘¤ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø§ÛŒÙ‡ Ú©Ø§Ø±Ø¨Ø±</span></div>
    <form method="post" style="padding:1rem 1.1rem">
      {% csrf_token %}
      <input type="hidden" name="action" value="basic_info">

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.65rem;margin-bottom:.65rem">
        <div>
          <label class="lbl">Ù†Ø§Ù… *</label>
          <input type="text" name="first_name" value="{{ u.first_name }}" required class="fi">
        </div>
        <div>
          <label class="lbl">Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ *</label>
          <input type="text" name="last_name" value="{{ u.last_name }}" required class="fi">
        </div>
      </div>

      <div style="margin-bottom:.65rem">
        <label class="lbl">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ (username) *</label>
        <input type="text" name="username" value="{{ u.username }}" required class="fi" style="font-family:monospace">
        <small style="color:var(--text-muted);font-size:.72rem">âš ï¸ ØªØºÛŒÛŒØ± Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù„Ø§Ú¯â€ŒØ§ÙˆØª Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</small>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.65rem;margin-bottom:.85rem">
        <div>
          <label class="lbl">Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„</label>
          <input type="text" name="phone" value="{{ u.phone }}" class="fi" maxlength="11" placeholder="09XXXXXXXXX">
        </div>
        <div>
          <label class="lbl">Ø§ÛŒÙ…ÛŒÙ„</label>
          <input type="email" name="email" value="{{ u.email }}" class="fi" placeholder="name@mail.com">
        </div>
      </div>

      <button type="submit" class="btn btn-navy btn-sm" style="width:100%">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø§ÛŒÙ‡</button>
    </form>
  </div>

  <!-- â‘¡ Ù†Ù‚Ø´â€ŒÙ‡Ø§ -->
  <div class="card">
    <div class="card-header"><span class="card-title">ğŸ­ Ù†Ù‚Ø´â€ŒÙ‡Ø§ Ùˆ Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§</span></div>
    <form method="post" style="padding:1rem 1.1rem">
      {% csrf_token %}
      <input type="hidden" name="action" value="roles">

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-bottom:.85rem">
        <label class="role-cb {% if u.is_technical_director %}role-on{% endif %}">
          <input type="checkbox" name="is_technical_director" {% if u.is_technical_director %}checked{% endif %}>
          ğŸ¯ Ù…Ø¯ÛŒØ± ÙÙ†ÛŒ
        </label>
        <label class="role-cb {% if u.is_finance_manager %}role-on{% endif %}">
          <input type="checkbox" name="is_finance_manager" {% if u.is_finance_manager %}checked{% endif %}>
          ğŸ’° Ù…Ø¯ÛŒØ± Ù…Ø§Ù„ÛŒ
        </label>
        <label class="role-cb {% if u.is_coach %}role-on{% endif %}">
          <input type="checkbox" name="is_coach" {% if u.is_coach %}checked{% endif %} id="role-coach-cb">
          ğŸ‘¨â€ğŸ« Ù…Ø±Ø¨ÛŒ
        </label>
        <label class="role-cb {% if u.is_player %}role-on{% endif %}">
          <input type="checkbox" name="is_player" {% if u.is_player %}checked{% endif %}>
          âš½ Ø¨Ø§Ø²ÛŒÚ©Ù†
        </label>
        <label class="role-cb {% if u.is_active %}role-active{% else %}role-inactive{% endif %}" style="grid-column:span 2">
          <input type="checkbox" name="is_active" {% if u.is_active %}checked{% endif %}>
          âœ… Ø­Ø³Ø§Ø¨ ÙØ¹Ø§Ù„ Ø§Ø³Øª
        </label>
      </div>

      {% if not coach %}
      <div id="coach-hint" style="display:{% if u.is_coach %}block{% else %}none{% endif %};
           font-size:.78rem;background:#fef3c7;color:#92400e;border-radius:6px;padding:.5rem .75rem;margin-bottom:.65rem">
        âš ï¸ Ø¨Ø§ Ø°Ø®ÛŒØ±Ù‡ØŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø±Ø¨ÛŒ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€” Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÛŒ Ø±Ø§ Ø³Ù¾Ø³ ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯.
      </div>
      {% endif %}

      <button type="submit" class="btn btn-navy btn-sm" style="width:100%">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ù†Ù‚Ø´â€ŒÙ‡Ø§</button>
    </form>
  </div>

  <!-- â‘¢ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± -->
  <div class="card">
    <div class="card-header"><span class="card-title">ğŸ”‘ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</span></div>
    <form method="post" style="padding:1rem 1.1rem">
      {% csrf_token %}
      <input type="hidden" name="action" value="reset_password">

      <div style="margin-bottom:.65rem">
        <label class="lbl">Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯ (Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ±)</label>
        <input type="password" name="new_password" required minlength="6" class="fi" autocomplete="new-password" placeholder="Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯...">
      </div>
      <div style="margin-bottom:.85rem">
        <label class="lbl">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯</label>
        <input type="password" name="confirm_password" required minlength="6" class="fi" autocomplete="new-password" placeholder="ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø²...">
      </div>
      <button type="submit" class="btn btn-amber btn-sm" style="width:100%"
              onclick="return confirm('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± ØªØºÛŒÛŒØ± Ú©Ù†Ø¯ØŸ')">
        ğŸ”‘ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±
      </button>
    </form>
  </div>

</div>

<!-- â•â•â• Ø³ØªÙˆÙ† Ø±Ø§Ø³Øª â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div style="display:flex;flex-direction:column;gap:1rem">

  <!-- â‘£ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÛŒ (Ø§Ú¯Ø± is_coach Ø¨Ø§Ø´Ù‡) -->
  {% if u.is_coach %}
  <div class="card">
    <div class="card-header">
      <span class="card-title">ğŸ‘¨â€ğŸ« Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÛŒ</span>
      {% if coach %}
        <span class="badge {% if coach.is_active %}badge-green{% else %}badge-red{% endif %}" style="font-size:.68rem">
          {% if coach.is_active %}ÙØ¹Ø§Ù„{% else %}ØºÛŒØ±ÙØ¹Ø§Ù„{% endif %}
        </span>
      {% else %}
        <span class="badge badge-amber" style="font-size:.68rem">âš ï¸ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ø§Ù‚Øµ</span>
      {% endif %}
    </div>

    {% if coach %}
    <form method="post" style="padding:1rem 1.1rem">
      {% csrf_token %}
      <input type="hidden" name="action" value="coach_info">

      <!-- Ù†Ø§Ù… Ù…Ø±Ø¨ÛŒ (Ø¬Ø¯Ø§ Ø§Ø² Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ) -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.65rem;margin-bottom:.65rem">
        <div>
          <label class="lbl">Ù†Ø§Ù… Ù…Ø±Ø¨ÛŒ *</label>
          <input type="text" name="coach_first_name" value="{{ coach.first_name }}" required class="fi">
        </div>
        <div>
          <label class="lbl">Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ *</label>
          <input type="text" name="coach_last_name" value="{{ coach.last_name }}" required class="fi">
        </div>
      </div>

      <!-- Ù…ÙˆØ¨Ø§ÛŒÙ„ + Ù…Ø¯Ø±Ú© -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.65rem;margin-bottom:.65rem">
        <div>
          <label class="lbl">Ù…ÙˆØ¨Ø§ÛŒÙ„ Ù…Ø±Ø¨ÛŒ</label>
          <input type="text" name="coach_phone" value="{{ coach.phone }}" class="fi" maxlength="11" placeholder="09XXXXXXXXX">
        </div>
        <div>
          <label class="lbl">Ù…Ø¯Ø±Ú© Ù…Ø±Ø¨ÛŒÚ¯Ø±ÛŒ</label>
          <select name="degree" class="fi">
            <option value="">â€” Ø§Ù†ØªØ®Ø§Ø¨ â€”</option>
            {% for val, lbl in degree_choices %}
            <option value="{{ val }}" {% if coach.degree == val %}selected{% endif %}>{{ lbl }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <!-- Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª -->
      <div style="margin-bottom:.85rem">
        <label class="lbl">Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ø¨Ø§Ù†Ú©ÛŒ (Û±Û¶ Ø±Ù‚Ù…)</label>
        <input type="text" name="bank_card_number" value="{{ coach.bank_card_number }}"
               class="fi" maxlength="16" style="font-family:monospace;letter-spacing:.06em"
               placeholder="Ø¨Ø¯ÙˆÙ† Ø®Ø· ØªÛŒØ±Ù‡ØŒ Û±Û¶ Ø±Ù‚Ù…">
        {% if coach.bank_card_number %}
        <small style="color:var(--text-muted);font-size:.72rem">
          Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡: {{ coach.bank_card_number|slice:":4" }}-****-****-{{ coach.bank_card_number|slice:"-4:" }}
        </small>
        {% endif %}
      </div>

      <!-- ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ø§Ù„ -->
      <div style="margin-bottom:.85rem">
        <label class="role-cb {% if coach.is_active %}role-active{% else %}role-inactive{% endif %}">
          <input type="checkbox" name="coach_is_active" {% if coach.is_active %}checked{% endif %}>
          âœ… Ù…Ø±Ø¨ÛŒ ÙØ¹Ø§Ù„ Ø§Ø³Øª
        </label>
      </div>

      <button type="submit" class="btn btn-navy btn-sm" style="width:100%">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÛŒ</button>
    </form>

    <!-- Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ ØªØ¯Ø±ÛŒØ³ (ÙÙ‚Ø· Ù†Ù…Ø§ÛŒØ´) -->
    {% if coach.coach_rates.all %}
    <div style="border-top:1px solid var(--surface-2);padding:.75rem 1.1rem">
      <p style="font-size:.75rem;font-weight:700;color:var(--text-muted);margin-bottom:.4rem">ğŸ“š Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ ØªØ¯Ø±ÛŒØ³ Ùˆ Ù†Ø±Ø®:</p>
      {% for rate in coach.coach_rates.all %}
      <div style="display:flex;justify-content:space-between;font-size:.8rem;padding:.3rem 0;border-bottom:1px solid var(--surface-2)">
        <span>{{ rate.category.name }}</span>
        <span style="font-family:monospace;color:var(--navy)">{{ rate.session_rate|floatformat:0 }} Ø±ÛŒØ§Ù„/Ø¬Ù„Ø³Ù‡</span>
      </div>
      {% endfor %}
    </div>
    {% endif %}

    {% else %}
    <!-- Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø±Ø¨ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ù‡ -->
    <div style="padding:1.25rem;text-align:center;color:var(--text-muted);font-size:.85rem">
      <p>Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø±Ø¨ÛŒ Ù‡Ù†ÙˆØ² Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´Ø¯Ù‡.</p>
      <p style="font-size:.75rem;margin-top:.35rem">Ù†Ù‚Ø´ Ù…Ø±Ø¨ÛŒ Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯ ØªØ§ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆØ¯.</p>
    </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- â‘¤ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¨Ø§Ø²ÛŒÚ©Ù† (Ø§Ú¯Ø± Ù„ÛŒÙ†Ú© Ø¯Ø§Ø±Ù‡) -->
  {% if player %}
  <div class="card">
    <div class="card-header"><span class="card-title">âš½ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¨Ø§Ø²ÛŒÚ©Ù†</span></div>
    <div style="padding:.85rem 1.1rem;display:grid;grid-template-columns:1fr 1fr;gap:.45rem;font-size:.82rem">
      <div>
        <span style="color:var(--text-muted)">Ú©Ø¯ Ù…Ù„ÛŒ:</span>
        <strong style="font-family:monospace"> {{ player.national_id }}</strong>
      </div>
      <div>
        <span style="color:var(--text-muted)">ÙˆØ¶Ø¹ÛŒØª:</span>
        <span class="badge badge-{% if player.status == 'approved' %}green{% elif player.status == 'rejected' %}red{% else %}amber{% endif %}" style="font-size:.68rem">
          {{ player.get_status_display }}
        </span>
      </div>
      <div><span style="color:var(--text-muted)">Ù…ÙˆØ¨Ø§ÛŒÙ„:</span> <span style="font-family:monospace">{{ player.phone }}</span></div>
      <div><span style="color:var(--text-muted)">Ø³Ù†:</span> {{ player.age|default:"â€”" }} Ø³Ø§Ù„</div>
    </div>
    <div style="padding:0 1.1rem .75rem">
      <a href="{% url 'registration:player-detail' player.pk %}" class="btn btn-outline btn-sm"
         style="width:100%;text-align:center;justify-content:center">
        ğŸ‘¤ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ù…Ù„
      </a>
    </div>
  </div>
  {% endif %}

  <!-- â‘¥ Ø®Ù„Ø§ØµÙ‡ Ø­Ø³Ø§Ø¨ -->
  <div class="card">
    <div class="card-header"><span class="card-title">â„¹ï¸ Ø®Ù„Ø§ØµÙ‡ Ø­Ø³Ø§Ø¨</span></div>
    <div style="padding:.85rem 1.1rem;font-size:.82rem">

      <!-- Ù†Ù‚Ø´â€ŒÙ‡Ø§ -->
      <div style="padding:.3rem 0;border-bottom:1px solid var(--surface-2);margin-bottom:.4rem">
        <span style="color:var(--text-muted);font-size:.78rem;display:block;margin-bottom:.3rem">Ù†Ù‚Ø´â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ:</span>
        <div style="display:flex;gap:.3rem;flex-wrap:wrap">
          {% if u.is_superuser %}<span class="badge" style="background:#7c3aed;color:#fff;font-size:.68rem">â­ Ø³ÙˆÙ¾Ø±</span>{% endif %}
          {% if u.is_technical_director %}<span class="badge badge-navy" style="font-size:.68rem">ğŸ¯ Ù…Ø¯ÛŒØ± ÙÙ†ÛŒ</span>{% endif %}
          {% if u.is_finance_manager %}<span class="badge badge-green" style="font-size:.68rem">ğŸ’° Ù…Ø¯ÛŒØ± Ù…Ø§Ù„ÛŒ</span>{% endif %}
          {% if u.is_coach %}<span class="badge badge-amber" style="font-size:.68rem">ğŸ‘¨â€ğŸ« Ù…Ø±Ø¨ÛŒ</span>{% endif %}
          {% if u.is_player %}<span class="badge" style="background:#f97316;color:#fff;font-size:.68rem">âš½ Ø¨Ø§Ø²ÛŒÚ©Ù†</span>{% endif %}
          {% if not u.is_superuser and not u.is_technical_director and not u.is_finance_manager and not u.is_coach and not u.is_player %}
          <span style="color:var(--text-muted);font-size:.78rem">Ø¨Ø¯ÙˆÙ† Ù†Ù‚Ø´</span>
          {% endif %}
        </div>
      </div>

      <div style="display:grid;gap:.3rem">
        <div style="display:flex;justify-content:space-between">
          <span style="color:var(--text-muted)">Ø¢Ø®Ø±ÛŒÙ† ÙˆØ±ÙˆØ¯:</span>
          <span>{{ u.last_login|date:"Y/m/d H:i"|default:"â€”" }}</span>
        </div>
        <div style="display:flex;justify-content:space-between">
          <span style="color:var(--text-muted)">ÙˆØ¶Ø¹ÛŒØª:</span>
          <span class="badge {% if u.is_active %}badge-green{% else %}badge-red{% endif %}" style="font-size:.72rem">
            {% if u.is_active %}âœ… ÙØ¹Ø§Ù„{% else %}âŒ ØºÛŒØ±ÙØ¹Ø§Ù„{% endif %}
          </span>
        </div>
      </div>
    </div>
    <div style="padding:0 1.1rem .85rem;display:flex;flex-direction:column;gap:.35rem">
      <a href="{% url 'payroll:my-financial-history' %}" class="btn btn-outline btn-sm" style="text-align:center;justify-content:center">
        ğŸ“Š ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø§Ù„ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±
      </a>
    </div>
  </div>

</div>
</div><!-- /grid -->

<!-- â”€â”€â”€ Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<style>
.lbl { font-size:.8rem; font-weight:700; display:block; margin-bottom:.3rem; color:var(--text-primary); }
.fi  { width:100%; padding:.5rem .75rem; border:1.5px solid var(--surface-2); border-radius:8px;
       font-family:inherit; font-size:.875rem; box-sizing:border-box; transition:border-color .15s; }
.fi:focus { outline:none; border-color:var(--navy); }
select.fi { background:#fff; }

.role-cb { display:flex; align-items:center; gap:.5rem; padding:.55rem .75rem;
           border-radius:8px; border:1.5px solid var(--surface-2); cursor:pointer;
           font-size:.85rem; user-select:none; }
.role-cb input[type=checkbox] { width:16px; height:16px; accent-color:var(--navy); flex-shrink:0; }
.role-on     { background:#f0f9ff; border-color:#bae6fd; }
.role-active { background:#dcfce7; border-color:#86efac; }
.role-inactive { background:#fee2e2; border-color:#fca5a5; }
</style>

<!-- â”€â”€â”€ Script â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<script>
// Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù† hint Ø§Ú¯Ø± Ù†Ù‚Ø´ Ù…Ø±Ø¨ÛŒ ØªÛŒÚ© Ø¨Ø®ÙˆØ±Ù‡ ÙˆÙ„ÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ø¯Ø§Ø±Ù‡
const coachCb   = document.getElementById('role-coach-cb');
const coachHint = document.getElementById('coach-hint');
if (coachCb && coachHint) {
  coachCb.addEventListener('change', () => {
    coachHint.style.display = coachCb.checked ? 'block' : 'none';
  });
}
</script>
{% endblock %}