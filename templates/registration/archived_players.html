{% extends "base.html" %}
{% block title %}Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¢Ø±Ø´ÛŒÙˆâ€ŒØ´Ø¯Ù‡{% endblock %}

{% block breadcrumb %}
  <span class="sep">â€º</span>
  <a href="#" style="text-decoration:none;color:inherit">Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†</a>
  <span class="sep">â€º</span>
  <span class="cur">Ø¢Ø±Ø´ÛŒÙˆ</span>
{% endblock %}

{% block extra_head %}
<style>
.archive-row {
  display: grid;
  grid-template-columns: 44px 1fr 160px 160px 1fr 120px;
  gap: .75rem; align-items: center;
  padding: .8rem 1.25rem;
  border-bottom: 1px solid var(--surface);
  transition: background .12s;
  opacity: .85;
}
.archive-row:hover { background: var(--surface); opacity: 1; }
.archive-row:last-child { border-bottom: none; }
.archive-avatar {
  width: 38px; height: 38px; border-radius: 50%;
  background: var(--surface-2); border: 2px dashed var(--text-light);
  display: flex; align-items: center; justify-content: center;
  font-size: .8rem; color: var(--text-muted); font-weight: 700;
}
.reason-text { font-size: .78rem; color: var(--red); }
.restore-btn { transition: transform .15s; }
.restore-btn:hover { transform: scale(1.05); }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
  <div>
    <h1>ğŸ—„ï¸ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¢Ø±Ø´ÛŒÙˆâ€ŒØ´Ø¯Ù‡</h1>
    <p>{{ total_archived }} Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¢Ø±Ø´ÛŒÙˆ Ø´Ø¯Ù‡ Ø§Ø³Øª â€” Ø¨Ø¯ÙˆÙ† Ø­Ø°Ù Ø§Ø² Ø³ÛŒØ³ØªÙ…</p>
  </div>
  <a href="{% url 'registration:applicant-list' %}" class="btn btn-outline">â† Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† ÙØ¹Ø§Ù„</a>
</div>

<div class="card mb-2" style="padding:.75rem 1.25rem">
  <form method="get" style="display:flex;gap:.5rem">
    <input type="text" name="q" value="{{ search_query }}"
           class="form-control" style="max-width:280px"
           placeholder="Ø¬Ø³ØªØ¬Ùˆ Ù†Ø§Ù… / Ú©Ø¯ Ù…Ù„ÛŒ ...">
    <button type="submit" class="btn btn-primary">Ø¬Ø³ØªØ¬Ùˆ</button>
    {% if search_query %}
      <a href="?" class="btn btn-outline">âœ• Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†</a>
    {% endif %}
  </form>
</div>

<div class="card">
  {% if players %}
  <div class="archive-row" style="background:var(--surface);font-size:.72rem;color:var(--text-muted);font-weight:700">
    <div></div>
    <div>Ù†Ø§Ù…</div>
    <div>ØªØ§Ø±ÛŒØ® Ø¢Ø±Ø´ÛŒÙˆ</div>
    <div>Ø¢Ø±Ø´ÛŒÙˆ Ø´Ø¯Ù‡ ØªÙˆØ³Ø·</div>
    <div>Ø¯Ù„ÛŒÙ„</div>
    <div>Ø¹Ù…Ù„ÛŒØ§Øª</div>
  </div>

  {% for player in players %}
  <div class="archive-row">
    <div class="archive-avatar">
      {{ player.first_name|slice:":1" }}{{ player.last_name|slice:":1" }}
    </div>

    <div>
      <div style="font-weight:700;font-size:.9rem">{{ player.first_name }} {{ player.last_name }}</div>
      <div style="font-size:.75rem;color:var(--text-muted)">
        Ú©Ø¯ Ù…Ù„ÛŒ: {{ player.national_id }} | {{ player.player_id }}
      </div>
    </div>

    <div style="font-size:.82rem;color:var(--text-muted)">
      {% if player.archived_at %}{{ player.archived_at|date:"Y/m/d" }}{% else %}â€”{% endif %}
    </div>

    <div style="font-size:.82rem">
      {% if player.approved_by %}{{ player.approved_by.get_full_name }}{% else %}â€”{% endif %}
    </div>

    <div class="reason-text">
      {{ player.archive_reason|default:"â€”"|truncatechars:60 }}
    </div>

    <div>
      <form method="post" action="{% url 'registration:restore-player' player.pk %}"
            onsubmit="return confirm('Ø§Ø² Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ {{ player.first_name }} {{ player.last_name }} Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')">
        {% csrf_token %}
        <button type="submit" class="btn btn-green btn-sm restore-btn">
          â™»ï¸ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ
        </button>
      </form>
    </div>
  </div>
  {% endfor %}

  {% if is_paginated %}
  <div style="display:flex;justify-content:center;gap:.5rem;padding:1rem;border-top:1px solid var(--surface)">
    {% if page_obj.has_previous %}
      <a href="?q={{ search_query }}&page={{ page_obj.previous_page_number }}" class="btn btn-outline btn-sm">â† Ù‚Ø¨Ù„ÛŒ</a>
    {% endif %}
    <span class="btn btn-sm" style="background:var(--surface)">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?q={{ search_query }}&page={{ page_obj.next_page_number }}" class="btn btn-outline btn-sm">Ø¨Ø¹Ø¯ÛŒ â†’</a>
    {% endif %}
  </div>
  {% endif %}

  {% else %}
  <div style="text-align:center;padding:4rem;color:var(--text-muted)">
    <div style="font-size:3rem;margin-bottom:1rem">ğŸ—„ï¸</div>
    <h3>Ù‡ÛŒÚ† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¢Ø±Ø´ÛŒÙˆØ´Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</h3>
  </div>
  {% endif %}
</div>
{% endblock %}