{% extends "base.html" %}
{% block title %}Ø¬Ø²Ø¦ÛŒØ§Øª Ø¬Ù„Ø³Ù‡{% endblock %}
{% block nav_finance %}active{% endblock %}

{% block breadcrumb %}
  <span class="sep">â€º</span>
  <a href="{% url 'payroll:finance-attendance-cats' %}" style="text-decoration:none;color:inherit">Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨</a>
  <span class="sep">â€º</span>
  <a href="{% url 'payroll:finance-attendance-sheet' session.sheet.category_id %}" style="text-decoration:none;color:inherit">{{ category.name }}</a>
  <span class="sep">â€º</span><span class="cur">Ø¬Ù„Ø³Ù‡ {{ session.session_number }}</span>
{% endblock %}

{% block content %}
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:1.25rem;flex-wrap:wrap;gap:.75rem">
  <div>
    <h1 style="font-size:1.1rem;font-weight:900;color:var(--navy)">ğŸ“‹ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¬Ù„Ø³Ù‡ {{ session.session_number }} â€” {{ category.name }}</h1>
    <p style="font-size:.82rem;color:var(--text-muted)">ØªØ§Ø±ÛŒØ®: {{ session.date }} &nbsp;|&nbsp; ÙÙ‚Ø·â€ŒØ®ÙˆØ§Ù†Ø¯Ù†ÛŒ</p>
  </div>
  <a href="{% url 'payroll:finance-attendance-sheet' category.pk %}" class="btn btn-outline btn-sm">â† Ø¨Ø§Ø²Ú¯Ø´Øª</a>
</div>

<div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem">
  <div class="card">
    <div class="card-header"><span class="card-title">ğŸ‘¨â€ğŸ« ÙˆØ¶Ø¹ÛŒØª Ù…Ø±Ø¨ÛŒØ§Ù†</span></div>
    {% if session.coach_records.all %}
    <div style="padding:.6rem .85rem">
      {% for rec in session.coach_records.all %}
      <div style="display:flex;align-items:center;justify-content:space-between;padding:.4rem 0;border-bottom:1px solid var(--surface-2)">
        <span style="font-size:.875rem">{{ rec.coach.first_name }} {{ rec.coach.last_name }}</span>
        {% if rec.status == 'present' %}
        <span class="badge badge-green" style="font-size:.68rem">âœ… Ø­Ø§Ø¶Ø±</span>
        {% elif rec.status == 'excused' %}
        <span class="badge badge-amber" style="font-size:.68rem">âš ï¸ Ù…ÙˆØ¬Ù‡</span>
        {% else %}
        <span class="badge badge-red" style="font-size:.68rem">âŒ ØºØ§ÛŒØ¨</span>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div style="padding:1rem;text-align:center;color:var(--text-muted);font-size:.85rem">Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</div>
    {% endif %}
  </div>

  <div class="card">
    <div class="card-header">
      <span class="card-title">âš½ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†</span>
      <div style="display:flex;gap:.35rem">
        <span class="badge badge-green" style="font-size:.65rem">
          Ø­Ø§Ø¶Ø±: {{ attendances|length }}
        </span>
      </div>
    </div>
    {% if attendances %}
    <div style="padding:.6rem .85rem;max-height:400px;overflow-y:auto">
      {% for rec in attendances %}
      <div style="display:flex;align-items:center;justify-content:space-between;padding:.35rem 0;border-bottom:1px solid var(--surface-2)">
        <span style="font-size:.85rem">{{ rec.player.first_name }} {{ rec.player.last_name }}</span>
        {% if rec.status == 'present' %}
        <span class="badge badge-green" style="font-size:.65rem">âœ… Ø­Ø§Ø¶Ø±</span>
        {% elif rec.status == 'excused' %}
        <span class="badge badge-amber" style="font-size:.65rem">âš ï¸ Ù…ÙˆØ¬Ù‡</span>
        {% else %}
        <span class="badge badge-red" style="font-size:.65rem">âŒ ØºØ§ÛŒØ¨</span>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div style="padding:1rem;text-align:center;color:var(--text-muted);font-size:.85rem">Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</div>
    {% endif %}
  </div>
</div>
{% endblock %}
