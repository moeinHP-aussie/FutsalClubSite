{% extends "base.html" %}
{% load static %}
{% block title %}Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ â€” Ø¨Ø§Ø´Ú¯Ø§Ù‡ Ø§Ø³Ù¾Ø§Ø¯{% endblock %}
{% block nav_dashboard %}active{% endblock %}

{% block breadcrumb %}
  <span class="cur">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
{% endblock %}

{% block extra_head %}
<style>
/* â”€â”€ Greeting Banner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.greeting-banner {
  background: linear-gradient(135deg, #0d1b2a 0%, #1a3150 60%, #0d1b2a 100%);
  border-radius: var(--radius);
  padding: 1.5rem 1.75rem;
  margin-bottom: 1.5rem;
  display: flex; align-items: center; justify-content: space-between;
  gap: 1rem; flex-wrap: wrap;
  position: relative; overflow: hidden;
  box-shadow: 0 6px 24px rgba(13,27,42,.25);
}
.greeting-banner::before {
  content: "";
  position: absolute; inset: 0;
  background: repeating-linear-gradient(
    -45deg, transparent, transparent 30px,
    rgba(245,158,11,.03) 30px, rgba(245,158,11,.03) 31px
  );
}
.greeting-banner::after {
  content: "";
  position: absolute; top: -40px; left: -40px;
  width: 180px; height: 180px;
  background: radial-gradient(circle, rgba(245,158,11,.12) 0%, transparent 70%);
  border-radius: 50%;
}
.greeting-text { position: relative; z-index: 1; }
.greeting-text h1 {
  font-size: 1.5rem; font-weight: 900; color: #fff;
  margin-bottom: .25rem;
}
.greeting-text p { font-size: .875rem; color: rgba(255,255,255,.5); }
.greeting-badge {
  position: relative; z-index: 1;
  background: rgba(245,158,11,.15);
  border: 1px solid rgba(245,158,11,.25);
  border-radius: var(--radius-sm);
  padding: .6rem 1rem;
  text-align: center;
}
.greeting-badge .badge-num {
  font-size: 1.6rem; font-weight: 900; color: #fcd34d; line-height: 1;
}
.greeting-badge .badge-lbl {
  font-size: .7rem; color: rgba(255,255,255,.5); margin-top: .15rem;
}

/* â”€â”€ Quick Action Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.quick-actions {
  display: flex; gap: .6rem; flex-wrap: wrap; margin-bottom: 1.5rem;
}
.quick-btn {
  display: flex; align-items: center; gap: .5rem;
  padding: .65rem 1.1rem;
  border-radius: var(--radius-sm);
  font-size: .85rem; font-weight: 700;
  text-decoration: none;
  transition: transform .15s, box-shadow .15s;
  border: none; cursor: pointer; font-family: inherit;
}
.quick-btn:hover { transform: translateY(-2px); }
.quick-btn.qb-amber { background: var(--amber); color: var(--navy); box-shadow: 0 4px 12px rgba(245,158,11,.3); }
.quick-btn.qb-navy  { background: var(--navy);  color: var(--white); box-shadow: 0 4px 12px rgba(13,27,42,.2); }
.quick-btn.qb-teal  { background: var(--teal);  color: var(--white); box-shadow: 0 4px 12px rgba(14,165,233,.25); }
.quick-btn.qb-green { background: var(--green); color: var(--white); box-shadow: 0 4px 12px rgba(16,185,129,.25); }

/* â”€â”€ Alert Ø¨Ø§ Ø·Ø±Ø§Ø­ÛŒ Ø¬ÙˆØ§Ù†â€ŒÙ¾Ø³Ù†Ø¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.alert-youth {
  border-radius: var(--radius);
  padding: 1rem 1.25rem;
  display: flex; align-items: center; gap: .85rem;
  margin-bottom: 1.25rem;
  border: none;
  position: relative; overflow: hidden;
}
.alert-youth.pending {
  background: linear-gradient(90deg, #fffbeb, #fef9c3);
  border-right: 4px solid var(--amber);
}
.alert-youth .alert-icon-wrap {
  width: 44px; height: 44px; border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.3rem; flex-shrink: 0;
  background: rgba(245,158,11,.15);
}
.alert-youth .alert-body { flex: 1; }
.alert-youth .alert-title { font-weight: 800; font-size: .95rem; color: #92400e; }
.alert-youth .alert-sub   { font-size: .82rem; color: #a16207; margin-top: .2rem; }
</style>
{% endblock %}

{% block content %}

{% if user.is_technical_director %}
{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ± ÙÙ†ÛŒ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}

<div class="greeting-banner">
  <div class="greeting-text">
    <h1>ğŸ‘‹ Ø³Ù„Ø§Ù…ØŒ {{ user.first_name|default:user.username }}!</h1>
    <p>Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ÙÙ†ÛŒ Ø¨Ø§Ø´Ú¯Ø§Ù‡ Ø§Ø³Ù¾Ø§Ø¯</p>
  </div>
  <div class="greeting-badge">
    <div class="badge-num">{{ total_players|default:0 }}</div>
    <div class="badge-lbl">Ø¨Ø§Ø²ÛŒÚ©Ù† ÙØ¹Ø§Ù„</div>
  </div>
</div>

<div class="grid-auto" style="margin-bottom:1.25rem">
  <div class="stat-card green">
    <div class="stat-label">Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† ÙØ¹Ø§Ù„</div>
    <div class="stat-value">{{ total_players|default:0 }}</div>
    <span class="stat-icon">âš½</span>
  </div>
  <div class="stat-card amber">
    <div class="stat-label">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯</div>
    <div class="stat-value">{{ pending_players|default:0 }}</div>
    <span class="stat-icon">â³</span>
  </div>
  <div class="stat-card navy">
    <div class="stat-label">Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</div>
    <div class="stat-value">{{ total_categories|default:0 }}</div>
    <span class="stat-icon">ğŸ“š</span>
  </div>
  <div class="stat-card teal">
    <div class="stat-label">Ø¢Ø±Ø´ÛŒÙˆâ€ŒØ´Ø¯Ù‡</div>
    <div class="stat-value">{{ archived_players|default:0 }}</div>
    <span class="stat-icon">ğŸ—„ï¸</span>
  </div>
</div>

{% if pending_players > 0 %}
<div class="alert-youth pending mb-2">
  <div class="alert-icon-wrap">â³</div>
  <div class="alert-body">
    <div class="alert-title">{{ pending_players }} Ù…ØªÙ‚Ø§Ø¶ÛŒ Ù…Ù†ØªØ¸Ø± Ø¨Ø±Ø±Ø³ÛŒ Ù‡Ø³ØªÙ†Ø¯</div>
    <div class="alert-sub">
      <a href="{% url 'registration:applicant-list' %}" class="btn btn-amber btn-sm" style="margin-top:.4rem;display:inline-flex">Ø¨Ø±Ø±Ø³ÛŒ Ù…ØªÙ‚Ø§Ø¶ÛŒØ§Ù† â†’</a>
    </div>
  </div>
</div>
{% endif %}

<div class="quick-actions">
  <a href="{% url 'registration:applicant-list' %}" class="quick-btn qb-amber">ğŸ“‹ Ù…ØªÙ‚Ø§Ø¶ÛŒØ§Ù† Ø¬Ø¯ÛŒØ¯</a>
  <a href="{% url 'attendance:category-list' %}" class="quick-btn qb-navy">ğŸ“… Ø«Ø¨Øª Ø­Ø¶ÙˆØ±</a>
  <a href="{% url 'comms:announcement-create' %}" class="quick-btn qb-teal">ğŸ“£ Ø§Ø·Ù„Ø§Ø¹ÛŒÙ‡ Ø¬Ø¯ÛŒØ¯</a>
  <a href="{% url 'exercises:gallery' %}" class="quick-btn qb-green">ğŸ¯ Ù…Ø®Ø²Ù† ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§</a>
</div>

{% if recent_players %}
<div class="card">
  <div class="card-header">
    <span class="card-title">ğŸ†• Ø¢Ø®Ø±ÛŒÙ† Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…â€ŒÙ‡Ø§</span>
    <a href="{% url 'registration:applicant-list' %}" class="btn btn-outline btn-sm">Ù‡Ù…Ù‡ â†</a>
  </div>
  <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Ù†Ø§Ù…</th><th>Ú©Ø¯ Ù…Ù„ÛŒ</th><th>ÙˆØ¶Ø¹ÛŒØª</th><th>ØªØ§Ø±ÛŒØ®</th></tr></thead>
      <tbody>
        {% for p in recent_players %}
        <tr>
          <td><strong>{{ p.first_name }} {{ p.last_name }}</strong></td>
          <td style="font-family:monospace;font-size:.82rem">{{ p.national_id }}</td>
          <td>
            {% if p.status == 'pending' %}<span class="badge badge-amber">â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</span>
            {% elif p.status == 'approved' %}<span class="badge badge-green">âœ… ØªØ£ÛŒÛŒØ¯</span>
            {% else %}<span class="badge badge-red">âŒ Ø±Ø¯</span>{% endif %}
          </td>
          <td style="font-size:.82rem;color:var(--text-muted)">{{ p.registration_date|date:"Y/m/d" }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endif %}

{% elif user.is_finance_manager %}
{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø§Ù„ÛŒ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}

<div class="greeting-banner">
  <div class="greeting-text">
    <h1>ğŸ’° Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø§Ù„ÛŒ</h1>
    <p>Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØŒ {{ user.get_full_name|default:user.username }}</p>
  </div>
  <a href="{% url 'payroll:finance-dashboard' %}" class="quick-btn qb-amber">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø§Ù„ÛŒ Ú©Ø§Ù…Ù„ â†’</a>
</div>

<div class="grid-auto" style="margin-bottom:1.5rem">
  <div class="stat-card amber">
    <div class="stat-label">ÙØ§Ú©ØªÙˆØ± Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
    <div class="stat-value">{{ pending_invoices|default:0 }}</div>
    <span class="stat-icon">ğŸ§¾</span>
  </div>
  <div class="stat-card red">
    <div class="stat-label">Ø¨Ø¯Ù‡Ú©Ø§Ø±Ø§Ù†</div>
    <div class="stat-value">{{ total_debt|default:0 }}</div>
    <span class="stat-icon">âš ï¸</span>
  </div>
  <div class="stat-card teal">
    <div class="stat-label">Ø­Ù‚ÙˆÙ‚ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
    <div class="stat-value">{{ pending_salaries|default:0 }}</div>
    <span class="stat-icon">ğŸ’³</span>
  </div>
</div>

{% elif user.is_coach %}
{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø±Ø¨ÛŒ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}

<div class="greeting-banner">
  <div class="greeting-text">
    <h1>ğŸ¯ Ø³Ù„Ø§Ù… Ù…Ø±Ø¨ÛŒ {{ user.first_name }}!</h1>
    <p>Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø±ÛŒÙ† Ø§Ù…Ø±ÙˆØ²ØŸ</p>
  </div>
  <div class="greeting-badge">
    <div class="badge-num">{{ total_players_coached|default:0 }}</div>
    <div class="badge-lbl">Ø¨Ø§Ø²ÛŒÚ©Ù† ØªØ­Øª Ù†Ø¸Ø±</div>
  </div>
</div>

<div class="grid-auto mb-2">
  <div class="stat-card green">
    <div class="stat-label">Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† ØªØ­Øª Ù†Ø¸Ø±</div>
    <div class="stat-value">{{ total_players_coached|default:0 }}</div>
    <span class="stat-icon">âš½</span>
  </div>
  <div class="stat-card navy">
    <div class="stat-label">Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ù†</div>
    <div class="stat-value">{{ my_categories.count|default:0 }}</div>
    <span class="stat-icon">ğŸ“š</span>
  </div>
</div>

<div class="quick-actions">
  <a href="{% url 'attendance:category-list' %}" class="quick-btn qb-navy">ğŸ“‹ Ø«Ø¨Øª Ø­Ø¶ÙˆØ±</a>
  <a href="{% url 'exercises:gallery' %}" class="quick-btn qb-amber">ğŸ¯ Ù…Ø®Ø²Ù† ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§</a>
  <a href="{% url 'comms:announcement-list' %}" class="quick-btn qb-teal">ğŸ“¢ Ø§Ø¹Ù„Ø§Ù†Ø§Øª</a>
</div>

{% elif user.is_player %}
{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù† â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}

<div class="greeting-banner">
  <div class="greeting-text">
    <h1>âš½ Ø³Ù„Ø§Ù… {{ user.first_name }}! Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØŸ</h1>
    <p>Ø¨Ù‡ Ù¾Ù†Ù„ Ø´Ø®ØµÛŒ Ø¨Ø§Ø´Ú¯Ø§Ù‡ ÙÙˆØªØ³Ø§Ù„ Ø§Ø³Ù¾Ø§Ø¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ</p>
  </div>
</div>

{% if my_pending_invoices > 0 %}
<div class="alert-youth pending mb-2">
  <div class="alert-icon-wrap">ğŸ§¾</div>
  <div class="alert-body">
    <div class="alert-title">{{ my_pending_invoices }} ÙØ§Ú©ØªÙˆØ± Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ†Ø´Ø¯Ù‡ Ø¯Ø§Ø±ÛŒ!</div>
    <div class="alert-sub">
      <a href="{% url 'payroll:invoice-list-player' %}" class="btn btn-amber btn-sm" style="margin-top:.4rem;display:inline-flex">Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ â†’</a>
    </div>
  </div>
</div>
{% endif %}

<div class="quick-actions">
  <a href="{% url 'comms:notification-list' %}" class="quick-btn qb-navy">ğŸ”” Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ù†</a>
  <a href="{% url 'comms:announcement-list' %}" class="quick-btn qb-teal">ğŸ“¢ Ø§Ø·Ù„Ø§Ø¹ÛŒÙ‡â€ŒÙ‡Ø§</a>
</div>

{% else %}
{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ù…ØªÙ‚Ø§Ø¶ÛŒ Ø¬Ø¯ÛŒØ¯ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}
<div class="card" style="text-align:center;padding:3rem">
  <div style="font-size:3.5rem;margin-bottom:1rem;animation:bounce 1s ease infinite">â³</div>
  <h2 style="font-size:1.3rem;font-weight:800">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…Øª Ø¯Ø± Ø¯Ø³Øª Ø¨Ø±Ø±Ø³ÛŒÙ‡!</h2>
  <p style="color:var(--text-muted);margin-top:.75rem;font-size:.9rem">
    Ù…Ø¯ÛŒØ± ÙÙ†ÛŒ Ø¨Ø§Ø´Ú¯Ø§Ù‡ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒØ§Øª Ø±Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù‡. ØªØ§ Ø§ÙˆÙ† Ù…ÙˆÙ‚Ø¹ ØµØ¨ÙˆØ± Ø¨Ø§Ø´ ğŸ’ª
  </p>
</div>

<style>
@keyframes bounce {
  0%,100% { transform: translateY(0); }
  50%      { transform: translateY(-8px); }
}
</style>
{% endif %}

{% endblock %}